# ЁЯУВ Data Preparation for PaddleOCR Text Recognition

р╕Др╕╣р╣Ир╕бр╕╖р╕нр╕Бр╕▓р╕гр╣Ар╕Хр╕гр╕╡р╕вр╕бр╕Вр╣Йр╕нр╕бр╕╣р╕ер╕кр╕│р╕лр╕гр╕▒р╕Ър╕Бр╕▓р╕гр╣Ар╕Чр╕гр╕Щ PaddleOCR Text Recognition models

## ЁЯОп р╕зр╕▒р╕Хр╕Цр╕╕р╕Ыр╕гр╕░р╕кр╕Зр╕Др╣М

р╣Ар╕Хр╕гр╕╡р╕вр╕бр╕Вр╣Йр╕нр╕бр╕╣р╕ер╕гр╕╣р╕Ыр╕ар╕▓р╕Юр╕Вр╣Йр╕нр╕Др╕зр╕▓р╕бр╣Бр╕ер╕░р╣Др╕Яр╕ер╣М annotation р╣Гр╕лр╣Йр╕нр╕вр╕╣р╣Ир╣Гр╕Щр╕гр╕╣р╕Ыр╣Бр╕Ър╕Ър╕Чр╕╡р╣Ир╣Ар╕лр╕бр╕▓р╕░р╕кр╕бр╕кр╕│р╕лр╕гр╕▒р╕Ър╕Бр╕▓р╕гр╣Ар╕Чр╕гр╕Щ Recognition model р╕Ър╕Щ SageMaker

## ЁЯУБ р╣Вр╕Др╕гр╕Зр╕кр╕гр╣Йр╕▓р╕З Directory

```
data_preparation/
тФЬтФАтФА README.md                    # р╕Др╕╣р╣Ир╕бр╕╖р╕нр╕Щр╕╡р╣Й
тФЬтФАтФА QUICKSTART.md               # р╕Др╕╣р╣Ир╕бр╕╖р╕нр╣Ар╕гр╕┤р╣Ир╕бр╕Хр╣Йр╕Щр╕нр╕вр╣Ир╕▓р╕Зр╣Ар╕гр╣Зр╕з
тФЬтФАтФА scripts/                    # Scripts р╕кр╕│р╕лр╕гр╕▒р╕Ър╕Ыр╕гр╕░р╕бр╕зр╕ер╕Ьр╕ер╕Вр╣Йр╕нр╕бр╕╣р╕е
тФВ   тФЬтФАтФА convert_data.py         # р╣Бр╕Ыр╕ер╕Зр╕Вр╣Йр╕нр╕бр╕╣р╕ер╣Ар╕Ыр╣Зр╕Щ Recognition format
тФВ   тФЬтФАтФА resize_images.py        # р╕Ыр╕гр╕▒р╕Ър╕Вр╕Щр╕▓р╕Фр╕гр╕╣р╕Ыр╕ар╕▓р╕Ю
тФВ   тФЬтФАтФА validate_data.py        # р╕Хр╕гр╕зр╕Ир╕кр╕нр╕Ър╕Др╕зр╕▓р╕бр╕Цр╕╣р╕Бр╕Хр╣Йр╕нр╕Зр╕Вр╕нр╕Зр╕Вр╣Йр╕нр╕бр╕╣р╕е
тФВ   тФЬтФАтФА upload_to_s3.py         # р╕нр╕▒р╕Ыр╣Вр╕лр╕ер╕Фр╣Др╕Ыр╕вр╕▒р╕З S3
тФВ   тФФтФАтФА utils.py                # р╕Яр╕▒р╕Зр╕Бр╣Мр╕Кр╕▒р╕Щр╕кр╕│р╕лр╕гр╕▒р╕Ър╣Гр╕Кр╣Йр╕гр╣Ир╕зр╕бр╕Бр╕▒р╕Щ
тФЬтФАтФА input/                      # р╕зр╕▓р╕Зр╕Вр╣Йр╕нр╕бр╕╣р╕ер╕Хр╣Йр╕Щр╕Йр╕Ър╕▒р╕Ър╕Чр╕╡р╣Ир╕Щр╕╡р╣И
тФВ   тФЬтФАтФА images/                 # р╕гр╕╣р╕Ыр╕ар╕▓р╕Юр╕Хр╣Йр╕Щр╕Йр╕Ър╕▒р╕Ъ
тФВ   тФФтФАтФА labels.txt              # р╣Др╕Яр╕ер╣М label р╕Хр╣Йр╕Щр╕Йр╕Ър╕▒р╕Ъ
тФФтФАтФА output/                     # р╕Ьр╕ер╕ер╕▒р╕Юр╕Шр╣Мр╕Чр╕╡р╣Ир╕Ыр╕гр╕░р╕бр╕зр╕ер╕Ьр╕ер╣Бр╕ер╣Йр╕з
    тФЬтФАтФА recognition_dataset/    # р╕Вр╣Йр╕нр╕бр╕╣р╕ер╕Юр╕гр╣Йр╕нр╕бр╕кр╕│р╕лр╕гр╕▒р╕Ър╣Ар╕Чр╕гр╕Щ
    тФФтФАтФА validation_reports/     # р╕гр╕▓р╕вр╕Зр╕▓р╕Щр╕Бр╕▓р╕гр╕Хр╕гр╕зр╕Ир╕кр╕нр╕Ъ
```

## ЁЯЪА р╕Бр╕▓р╕гр╣Ар╕гр╕┤р╣Ир╕бр╕Хр╣Йр╕Щр╕нр╕вр╣Ир╕▓р╕Зр╣Ар╕гр╣Зр╕з

### р╕Вр╕▒р╣Йр╕Щр╕Хр╕нр╕Щр╕Чр╕╡р╣И 1: р╕зр╕▓р╕Зр╕Вр╣Йр╕нр╕бр╕╣р╕ер╕Хр╣Йр╕Щр╕Йр╕Ър╕▒р╕Ъ
```bash
# р╕зр╕▓р╕Зр╕гр╕╣р╕Ыр╕ар╕▓р╕Юр╕Вр╕нр╕Зр╕Др╕╕р╕Ур╣Гр╕Щ input/images/
cp /path/to/your/images/* input/images/

# р╕зр╕▓р╕Зр╣Др╕Яр╕ер╣М labels.txt р╣Гр╕Щ input/
cp /path/to/your/labels.txt input/
```

### р╕Вр╕▒р╣Йр╕Щр╕Хр╕нр╕Щр╕Чр╕╡р╣И 2: р╕Хр╕┤р╕Фр╕Хр╕▒р╣Йр╕З Dependencies
```bash
pip install opencv-python pillow boto3 tqdm
```

### р╕Вр╕▒р╣Йр╕Щр╕Хр╕нр╕Щр╕Чр╕╡р╣И 3: р╣Бр╕Ыр╕ер╕Зр╕Вр╣Йр╕нр╕бр╕╣р╕е
```bash
# р╣Бр╕Ыр╕ер╕Зр╕Вр╣Йр╕нр╕бр╕╣р╕ер╕Чр╕▒р╣Йр╕Зр╕лр╕бр╕Ф (р╕гр╕▒р╕Щ script р╕лр╕ер╕▒р╕Б)
python scripts/convert_data.py

# р╕лр╕гр╕╖р╕нр╕гр╕▒р╕Щр╕Чр╕╡р╕ер╕░р╕Вр╕▒р╣Йр╕Щр╕Хр╕нр╕Щ
python scripts/resize_images.py      # р╕Ыр╕гр╕▒р╕Ър╕Вр╕Щр╕▓р╕Фр╕гр╕╣р╕Ыр╕ар╕▓р╕Ю
python scripts/validate_data.py     # р╕Хр╕гр╕зр╕Ир╕кр╕нр╕Ър╕Вр╣Йр╕нр╕бр╕╣р╕е
```

### р╕Вр╕▒р╣Йр╕Щр╕Хр╕нр╕Щр╕Чр╕╡р╣И 4: р╕нр╕▒р╕Ыр╣Вр╕лр╕ер╕Фр╣Др╕Ыр╕вр╕▒р╕З S3
```bash
# р╕Хр╕▒р╣Йр╕Зр╕Др╣Ир╕▓ AWS credentials р╕Бр╣Ир╕нр╕Щ
aws configure

# р╕нр╕▒р╕Ыр╣Вр╕лр╕ер╕Фр╕Вр╣Йр╕нр╕бр╕╣р╕е
python scripts/upload_to_s3.py --bucket your-bucket-name
```

## ЁЯУЭ р╕гр╕╣р╕Ыр╣Бр╕Ър╕Ър╕Вр╣Йр╕нр╕бр╕╣р╕ер╕Чр╕╡р╣Ир╕гр╕нр╕Зр╕гр╕▒р╕Ъ

### Input Format (р╕гр╕╣р╕Ыр╣Бр╕Ър╕Ър╣Ар╕гр╕┤р╣Ир╕бр╕Хр╣Йр╕Щ)
- **р╕гр╕╣р╕Ыр╕ар╕▓р╕Ю**: р╣Др╕Яр╕ер╣М `.jpg`, `.png`, `.jpeg` р╣Гр╕Щр╣Вр╕Яр╕ер╣Ар╕Фр╕нр╕гр╣М `input/images/`
- **Labels**: р╣Др╕Яр╕ер╣М `labels.txt` р╕Чр╕╡р╣Ир╕бр╕╡р╕гр╕╣р╕Ыр╣Бр╕Ър╕Ър╣Гр╕Фр╕Бр╣Зр╣Др╕Фр╣Й (script р╕Ир╕░р╣Бр╕Ыр╕ер╕Зр╣Гр╕лр╣Й)

### Output Format (р╕гр╕╣р╕Ыр╣Бр╕Ър╕Ър╕кр╕│р╕лр╕гр╕▒р╕Ъ Recognition)
- **р╕гр╕╣р╕Ыр╕ар╕▓р╕Ю**: р╕Вр╕Щр╕▓р╕Ф 32-48px height, р╕Др╕зр╕▓р╕бр╕Бр╕зр╣Йр╕▓р╕Зр╕Хр╕▓р╕бр╕кр╕▒р╕Фр╕кр╣Ир╕зр╕Щ
- **Annotation**: р╕гр╕╣р╕Ыр╣Бр╕Ър╕Ъ `image_path\ttext_content`

## ЁЯФз р╕Бр╕▓р╕гр╕Ыр╕гр╕▒р╕Ър╣Бр╕Хр╣Ир╕З Scripts

### р╕Бр╕▓р╕гр╕Ыр╕гр╕▒р╕Ър╕Вр╕Щр╕▓р╕Фр╕гр╕╣р╕Ыр╕ар╕▓р╕Ю
р╣Бр╕Бр╣Йр╣Др╕Вр╣Гр╕Щ `scripts/resize_images.py`:
```python
TARGET_HEIGHT = 32  # р╣Ар╕Ыр╕ер╕╡р╣Ир╕вр╕Щр╕Др╕зр╕▓р╕бр╕кр╕╣р╕Зр╕Чр╕╡р╣Ир╕Хр╣Йр╕нр╕Зр╕Бр╕▓р╕г
MIN_WIDTH = 16      # р╕Др╕зр╕▓р╕бр╕Бр╕зр╣Йр╕▓р╕Зр╕Вр╕▒р╣Йр╕Щр╕Хр╣Ир╕│
MAX_WIDTH = 512     # р╕Др╕зр╕▓р╕бр╕Бр╕зр╣Йр╕▓р╕Зр╕кр╕╣р╕Зр╕кр╕╕р╕Ф
```

### р╕Бр╕▓р╕гр╣Бр╕Ър╣Ир╕Зр╕Вр╣Йр╕нр╕бр╕╣р╕е Train/Validation
р╣Бр╕Бр╣Йр╣Др╕Вр╣Гр╕Щ `scripts/convert_data.py`:
```python
TRAIN_RATIO = 0.8   # р╕кр╕▒р╕Фр╕кр╣Ир╕зр╕Щ training data (80%)
VAL_RATIO = 0.2     # р╕кр╕▒р╕Фр╕кр╣Ир╕зр╕Щ validation data (20%)
```

## ЁЯУК р╕Бр╕▓р╕гр╕Хр╕гр╕зр╕Ир╕кр╕нр╕Ър╕Ьр╕ер╕ер╕▒р╕Юр╕Шр╣М

р╕лр╕ер╕▒р╕Зр╕Ир╕▓р╕Бр╕гр╕▒р╕Щ scripts р╣Бр╕ер╣Йр╕з р╕Хр╕гр╕зр╕Ир╕кр╕нр╕Ър╕Ьр╕ер╕ер╕▒р╕Юр╕Шр╣Мр╕Чр╕╡р╣И:
- `output/recognition_dataset/` - р╕Вр╣Йр╕нр╕бр╕╣р╕ер╕Юр╕гр╣Йр╕нр╕бр╕кр╕│р╕лр╕гр╕▒р╕Ър╣Ар╕Чр╕гр╕Щ
- `output/validation_reports/` - р╕гр╕▓р╕вр╕Зр╕▓р╕Щр╕Бр╕▓р╕гр╕Хр╕гр╕зр╕Ир╕кр╕нр╕Ъ

## тЪая╕П р╕Вр╣Йр╕нр╕Др╕зр╕гр╕гр╕░р╕зр╕▒р╕З

1. **р╕Хр╕гр╕зр╕Ир╕кр╕нр╕Ър╣Др╕Яр╕ер╣М input** р╕Бр╣Ир╕нр╕Щр╕гр╕▒р╕Щ scripts
2. **р╕кр╕│р╕гр╕нр╕Зр╕Вр╣Йр╕нр╕бр╕╣р╕е** р╕Хр╣Йр╕Щр╕Йр╕Ър╕▒р╕Ър╕Бр╣Ир╕нр╕Щр╕Ыр╕гр╕░р╕бр╕зр╕ер╕Ьр╕е
3. **р╕Хр╕гр╕зр╕Ир╕кр╕нр╕Ъ validation reports** р╕лр╕ер╕▒р╕Зр╣Бр╕Ыр╕ер╕Зр╕Вр╣Йр╕нр╕бр╕╣р╕е
4. **р╕Чр╕Фр╕кр╕нр╕Ър╕нр╕▒р╕Ыр╣Вр╕лр╕ер╕Ф S3** р╕Фр╣Йр╕зр╕вр╕Вр╣Йр╕нр╕бр╕╣р╕ер╣Ар╕ер╣Зр╕Бр╣Ж р╕Бр╣Ир╕нр╕Щ

## ЁЯФЧ р╕Вр╕▒р╣Йр╕Щр╕Хр╕нр╕Щр╕Цр╕▒р╕Фр╣Др╕Ы

р╣Ар╕бр╕╖р╣Ир╕нр╣Ар╕Хр╕гр╕╡р╕вр╕бр╕Вр╣Йр╕нр╕бр╕╣р╕ер╣Ар╕кр╕гр╣Зр╕Ир╣Бр╕ер╣Йр╕з:
1. р╣Др╕Ыр╕Чр╕╡р╣И Jupyter Notebook р╕лр╕ер╕▒р╕Б: `../paddle_ocr_recognition_training.ipynb`
2. р╕Хр╕▒р╣Йр╕Зр╕Др╣Ир╕▓ S3 paths р╣Гр╕лр╣Йр╕Хр╕гр╕Зр╕Бр╕▒р╕Ър╕Чр╕╡р╣Ир╕нр╕▒р╕Ыр╣Вр╕лр╕ер╕Фр╣Др╕зр╣Й
3. р╣Ар╕гр╕┤р╣Ир╕бр╕Бр╕▓р╕гр╣Ар╕Чр╕гр╕Щ Recognition model

## ЁЯУЮ р╕Бр╕▓р╕гр╣Бр╕Бр╣Йр╣Др╕Вр╕Ыр╕▒р╕Нр╕лр╕▓

р╕лр╕▓р╕Бр╣Ар╕Бр╕┤р╕Фр╕Ыр╕▒р╕Нр╕лр╕▓:
1. р╕Хр╕гр╕зр╕Ир╕кр╕нр╕Ъ `output/validation_reports/error_log.txt`
2. р╕нр╣Ир╕▓р╕Щ `../docs/troubleshooting.md`
3. р╕Ър╕▒р╕Щр╕Чр╕╢р╕Бр╕Ыр╕▒р╕Нр╕лр╕▓р╣Гр╕Щ `../docs/problem-log.md`
